<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Báo Cáo Lãi Suất Hà Tĩnh - Cập Nhật 14/01</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --primary-color: #0F172A;
            --accent-color: #3B82F6;
            --success-color: #10B981;
            --warning-color: #F59E0B;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #F8FAFC;
            color: #1E293B;
        }

        /* --- CHART CONTAINER STYLING --- */
        .chart-wrapper {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }

        @media (max-width: 768px) { .chart-wrapper { height: 300px; } }

        .card {
            background: white;
            border-radius: 1.25rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            border: 1px solid #F1F5F9;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .ai-glow {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { height: 6px; width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 10px; }

        .loading-dots:after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }
        @keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60% { content: '...'; } 80%, 100% { content: ''; } }
    </style>

    <!-- 
        Chosen Palette: Professional Finance (Blue, Emerald, Slate)
        Application Structure Plan:
        1. Contextual Header: Time and location indicators.
        2. Financial Snapshot: High-level metrics from the source report.
        3. Visual Analysis: Chart.js bar chart for multi-bank comparison with category filtering.
        4. AI Consultant (NEW): Integrated Gemini interface to process "1 Billion Plan" and "Rate Battle".
        5. Earnings Estimator: Interactive calculator to show profit differences.
        6. Source Data Table: Sortable and clean table of the 14/01 data.
        
        Why this structure?
        It translates a static report into an active decision-making tool. By adding AI, we allow the user to ask "What if?" instead of just seeing "What is".
    -->

    <!-- Visualization & Content Choices:
        - Bar Chart (Chart.js): Comparison of 12M rates across 8 banks. Interactive filtering by bank type.
        - Dynamic Text (JS): AI-generated responses based on bank segments and characteristics.
        - Grid Layout (Tailwind): To group "Pain Points" and "Advice" logically.
        - NO SVG/MERMAID: All icons use Unicode or FontAwesome. Charts use Canvas.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="p-4 md:p-10">

    <header class="max-w-7xl mx-auto mb-12 text-center">
        <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-slate-900 text-white text-[10px] font-bold uppercase tracking-[3px] mb-6">
            <i class="fa-solid fa-bolt-lightning text-amber-400"></i> Hà Tĩnh ● Data 14/01/2026
        </div>
        <h1 class="text-4xl md:text-6xl font-black text-slate-900 mb-4 tracking-tighter uppercase italic">Lãi Suất Battle AI ✨</h1>
        <p class="text-slate-500 max-w-2xl mx-auto text-lg font-medium">
            Hệ thống phân tích và đối chiếu lãi suất 19 ngân hàng tại Hà Tĩnh. Sử dụng trí tuệ nhân tạo để tối ưu hóa tài sản của bạn.
        </p>
    </header>

    <main class="max-w-7xl mx-auto space-y-10">

        <!-- AI WEALTH STRATEGIST (THE CORE UPGRADE) -->
        <section class="card p-8 bg-slate-900 text-white ai-glow relative overflow-hidden">
            <div class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-10 items-center">
                <div>
                    <h2 class="text-3xl font-black mb-4 flex items-center gap-3">
                        <i class="fa-solid fa-robot text-blue-400"></i> Trợ Lý Tài Chính AI ✨
                    </h2>
                    <p class="text-slate-400 text-sm mb-8 leading-relaxed">
                        Dựa trên dữ liệu thị trường Hà Tĩnh sáng nay, AI sẽ lập kế hoạch phân bổ vốn hoặc so sánh đối đầu các ngân hàng cho bạn.
                    </p>
                    <div class="flex flex-wrap gap-3">
                        <button onclick="askAI('wealth')" class="bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded-xl font-bold text-sm transition-all flex items-center gap-2">
                            <i class="fa-solid fa-vault"></i> Kế hoạch 1 Tỷ
                        </button>
                        <button onclick="askAI('battle')" class="bg-slate-800 hover:bg-slate-700 px-6 py-3 rounded-xl font-bold text-sm transition-all flex items-center gap-2 border border-slate-700">
                            <i class="fa-solid fa-swords"></i> So sánh đối đầu
                        </button>
                    </div>
                </div>
                <div id="ai-output" class="bg-slate-800/50 border border-slate-700 rounded-2xl p-6 min-h-[200px] text-sm text-slate-300 italic leading-relaxed whitespace-pre-line">
                    Nhấn vào nút chức năng để AI bắt đầu phân tích dữ liệu thị trường...
                </div>
            </div>
            <!-- Decorative Background Element -->
            <div class="absolute -right-20 -top-20 w-64 h-64 bg-blue-600/10 rounded-full blur-3xl"></div>
        </section>

        <!-- KPI & CHART SECTION -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 card p-8">
                <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                    <h3 class="text-xl font-bold text-slate-900">Xếp Hạng Lãi Suất (12 Tháng)</h3>
                    <div class="flex gap-2">
                        <button onclick="filterChart('all')" class="filter-btn active px-3 py-1.5 rounded-lg text-[10px] font-black uppercase bg-blue-600 text-white">Tất cả</button>
                        <button onclick="filterChart('Lãi cao')" class="filter-btn px-3 py-1.5 rounded-lg text-[10px] font-black uppercase bg-slate-100 text-slate-500">Lãi cao</button>
                        <button onclick="filterChart('Quốc doanh')" class="filter-btn px-3 py-1.5 rounded-lg text-[10px] font-black uppercase bg-slate-100 text-slate-500">Quốc doanh</button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="rateChart"></canvas>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="space-y-6">
                <div class="card p-6 border-l-4 border-emerald-500">
                    <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">Đỉnh thị trường</p>
                    <h4 class="text-3xl font-black text-slate-900 mt-1">7.20%</h4>
                    <p class="text-xs text-slate-500 mt-1">PGBank Hà Tĩnh</p>
                </div>
                <div class="card p-6 border-l-4 border-amber-500">
                    <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">Chênh lệch lợi nhuận</p>
                    <h4 class="text-3xl font-black text-slate-900 mt-1">2.00%</h4>
                    <p class="text-xs text-slate-500 mt-1">Giữa PGBank và Big 4</p>
                </div>
                <div class="card p-8 bg-blue-50 border-none">
                    <h4 class="font-bold text-blue-900 mb-3">Tư vấn nhanh ✨</h4>
                    <p class="text-xs text-blue-700 leading-relaxed italic">
                        "Nếu bạn ưu tiên quà Tết, hãy chọn BIDV hoặc Agribank II. Nếu chỉ cần tiền lãi, PGBank là 'vua' của tháng 1."
                    </p>
                </div>
            </div>
        </section>

        <!-- DATA EXPLORER -->
        <section class="card overflow-hidden">
            <div class="p-6 border-b border-slate-50 flex justify-between items-center bg-slate-50/30">
                <h3 class="font-bold text-slate-900 uppercase text-sm tracking-wider">Chi Tiết Niêm Yết Tại Quầy</h3>
                <div class="flex gap-2">
                    <div class="w-3 h-3 rounded-full bg-emerald-500"></div>
                    <div class="w-3 h-3 rounded-full bg-blue-600"></div>
                </div>
            </div>
            <div class="overflow-x-auto custom-scroll">
                <table class="w-full text-left text-sm border-collapse">
                    <thead class="bg-slate-900 text-white font-bold uppercase text-[10px] tracking-widest">
                        <tr>
                            <th class="px-8 py-5">Ngân hàng</th>
                            <th class="px-8 py-5 text-center">Lãi suất (%)</th>
                            <th class="px-8 py-5">Phân khúc</th>
                            <th class="px-8 py-5">Đặc điểm / Quà tặng</th>
                        </tr>
                    </thead>
                    <tbody id="bank-table-body" class="divide-y divide-slate-100">
                        <!-- JS Render -->
                    </tbody>
                </table>
            </div>
        </section>

    </main>

    <footer class="max-w-7xl mx-auto py-20 text-center border-t border-slate-100 mt-20">
        <p class="text-slate-400 text-[10px] font-black uppercase tracking-[5px]">AI Agent Orchestrator ● Hà Tĩnh ● 2026</p>
    </footer>

    <!-- JAVASCRIPT -->
    <script>
        // ##########################################################################
        // ### DÒNG 238: DÁN API KEY CỦA BẠN VÀO GIỮA CẶP NGOẶC KÉP DƯỚI ĐÂY !!! ###
        // ##########################################################################
        const apiKey = "AIzaSyAlojyUvA5CayJ2V0x7mv6L68iDdzSwe5g"; 
        // ##########################################################################

        const rawData = [
            { name: 'PGBank HT', rate: 7.20, segment: 'Lãi cao', info: 'Lãi suất dẫn đầu, không quà tặng.' },
            { name: 'Nam A Bank HT', rate: 6.80, segment: 'Lãi cao', info: 'Ưu đãi hưu trí Hà Tĩnh.' },
            { name: 'Bac A Bank', rate: 6.55, segment: 'Lãi cao', info: 'Thanh khoản nhanh, ổn định.' },
            { name: 'LPBank Hà Tĩnh', rate: 6.30, segment: 'TMCP Nhỏ', info: 'Mạng lưới huyện rất mạnh.' },
            { name: 'VPBank Hà Tĩnh', rate: 5.70, segment: 'TMCP Lớn', info: 'Cashback 100k trên App.' },
            { name: 'Techcombank', rate: 5.45, segment: 'TMCP Lớn', info: 'App mượt, sinh lời tự động.' },
            { name: 'Agribank HT II', rate: 5.20, segment: 'Quốc doanh', info: 'Chi nhánh mới, lì xì tại quầy.' },
            { name: 'Vietcombank', rate: 5.20, segment: 'Quốc doanh', info: 'Thương hiệu an toàn số 1.' }
        ];

        let currentData = [...rawData];
        let chartInstance = null;

        // --- GEMINI API INTEGRATION ---
        async function callGemini(prompt) {
            if (!apiKey) return "CẢNH BÁO: Bạn chưa dán API Key tại dòng 238. Vui lòng dán Key để kích hoạt AI!";
            
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: "Bạn là chuyên gia tài chính tại Hà Tĩnh. Hãy trả lời súc tích, chuyên sâu, thực tế bằng tiếng Việt." }] }
            };

            for (let i = 0; i < 3; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || "Lỗi phản hồi từ AI.";
                } catch (e) {
                    await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
                }
            }
            return "Hệ thống AI đang bận, vui lòng thử lại sau.";
        }

        async function askAI(type) {
            const output = document.getElementById('ai-output');
            output.innerHTML = '<span class="loading-dots text-blue-400 font-bold">Hệ thống đang quét dữ liệu thị trường Hà Tĩnh</span>';
            
            let prompt = "";
            if (type === 'wealth') {
                prompt = `Dựa trên dữ liệu: ${JSON.stringify(rawData)}, hãy lập kế hoạch phân bổ 1 tỷ VNĐ tối ưu tại Hà Tĩnh sáng nay.`;
            } else {
                prompt = `So sánh đối đầu lợi ích giữa nhóm ngân hàng lãi cao (PGBank) và nhóm quốc doanh (Agribank) tại Hà Tĩnh ngay lúc này.`;
            }

            const result = await callGemini(prompt);
            output.innerText = result;
        }

        // --- UI & CHARTS ---
        function wrapLabel(str, max = 15) {
            if (str.length <= max) return str;
            return [str.slice(0, max), str.slice(max)];
        }

        function initChart() {
            const ctx = document.getElementById('rateChart').getContext('2d');
            const colors = { 'Lãi cao': '#10B981', 'TMCP Nhỏ': '#6366F1', 'TMCP Lớn': '#3B82F6', 'Quốc doanh': '#1E3A8A' };

            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: currentData.map(d => wrapLabel(d.name)),
                    datasets: [{
                        label: 'Lãi suất (%)',
                        data: currentData.map(d => d.rate),
                        backgroundColor: currentData.map(d => colors[d.segment]),
                        borderRadius: 6,
                        barThickness: 35
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { min: 4, max: 8 }, x: { grid: { display: false } } }
                }
            });
        }

        function filterChart(seg) {
            currentData = seg === 'all' ? [...rawData] : rawData.filter(d => d.segment === seg);
            chartInstance.data.labels = currentData.map(d => wrapLabel(d.name));
            chartInstance.data.datasets[0].data = currentData.map(d => d.rate);
            const colors = { 'Lãi cao': '#10B981', 'TMCP Nhỏ': '#6366F1', 'TMCP Lớn': '#3B82F6', 'Quốc doanh': '#1E3A8A' };
            chartInstance.data.datasets[0].backgroundColor = currentData.map(d => colors[d.segment]);
            chartInstance.update();
            
            document.querySelectorAll('.filter-btn').forEach(b => {
                b.classList.remove('bg-blue-600', 'text-white');
                b.classList.add('bg-slate-100', 'text-slate-500');
            });
            event.target.classList.add('bg-blue-600', 'text-white');
            renderTable();
        }

        function renderTable() {
            const tbody = document.getElementById('bank-table-body');
            tbody.innerHTML = '';
            currentData.sort((a,b) => b.rate - a.rate).forEach(b => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-50 transition-colors";
                tr.innerHTML = `
                    <td class="px-8 py-5 font-bold text-slate-800">${b.name}</td>
                    <td class="px-8 py-5 text-center font-black text-blue-700 text-lg">${b.rate.toFixed(2)}%</td>
                    <td class="px-8 py-5"><span class="px-3 py-1 rounded-lg bg-slate-100 text-[10px] font-black uppercase text-slate-500">${b.segment}</span></td>
                    <td class="px-8 py-5 text-xs text-slate-500 italic">${b.info}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        window.onload = () => { initChart(); renderTable(); };
    </script>
</body>
</html>