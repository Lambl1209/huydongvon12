<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Hub H√† Tƒ©nh AI ‚ú® - Chi·∫øn L∆∞·ª£c 2026</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --primary-navy: #0F172A;
            --accent-emerald: #10B981;
            --accent-amber: #F59E0B;
            --bg-slate: #F8FAFC;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-slate);
            color: var(--primary-navy);
            -webkit-font-smoothing: antialiased;
        }

        /* --- MANDATORY CHART CONTAINER STYLING --- */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 1000px; /* Constrain width on large screens */
            margin-left: auto;
            margin-right: auto;
            height: 400px; /* Base height */
            max-height: 500px;
            background: white;
            border-radius: 1rem;
            padding: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        @media (max-width: 768px) {
            .chart-container {
                height: 350px; /* Adjust for mobile */
            }
        }

        /* --- CUSTOM COMPONENTS --- */
        .card {
            background: white;
            border-radius: 1.5rem;
            border: 1px solid #E2E8F0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .hero-gradient {
            background: linear-gradient(135deg, #0F172A 0%, #1E3A8A 100%);
            color: white;
        }

        .agri-gradient {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
        }

        .loading-dots:after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }
        @keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60% { content: '...'; } 80%, 100% { content: ''; } }

        .custom-scrollbar::-webkit-scrollbar { height: 6px; width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }

        .battle-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            align-items: center;
        }
        @media (max-width: 640px) { .battle-grid { grid-template-columns: 1fr; } }
    </style>

    <!-- Chosen Palette: "Trust & Growth" (Navy Blue, Emerald Green, Amber Gold) -->
    <!-- Application Structure Plan: 
         1. Header: Contextual data (Date, Location).
         2. Hero Section (Wealth Strategist): The primary value prop - AI planning for 1 Billion VND.
         3. Consultation Module: Specific focus on Agribank II (Local Insight).
         4. Market Overview: KPI Cards & Main Interactive Chart (Chart.js).
         5. AI Tools: Battle Mode & Alerts.
         6. Detailed Data: Sortable table for transparency.
         WHY: This structure prioritizes "Actionable Advice" over "Raw Data", guiding the user from strategy to details.
    -->
    <!-- Visualization & Content Choices:
         - Bar Chart: Best for ranking 19 banks.
         - Cards: For modular AI features.
         - Text-based Icons: FontAwesome used exclusively (NO SVG).
         - Chart.js: Used for canvas rendering.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="p-4 md:p-8 lg:p-12">

    <!-- HEADER -->
    <header class="max-w-7xl mx-auto text-center mb-12">
        <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-blue-50 text-blue-800 text-[10px] font-extrabold uppercase tracking-widest mb-6 border border-blue-100">
            <span class="w-2 h-2 bg-blue-600 rounded-full animate-pulse"></span>
            Live Data: 14/01/2026 ‚óè TP H√† Tƒ©nh
        </div>
        <h1 class="text-4xl md:text-6xl font-black text-slate-900 mb-4 tracking-tighter uppercase italic">
            Financial Hub <span class="text-blue-600">AI</span>
        </h1>
        <p class="text-slate-500 max-w-2xl mx-auto text-lg font-medium leading-relaxed">
            H·ªá th·ªëng qu·∫£n tr·ªã t√†i s·∫£n th√¥ng minh d√†nh ri√™ng cho ng∆∞·ªùi d√¢n H√† Tƒ©nh. T·ªëi ∆∞u h√≥a d√≤ng ti·ªÅn ti·∫øt ki·ªám v·ªõi d·ªØ li·ªáu th·ª±c t·∫ø t·ª´ 19 ng√¢n h√†ng.
        </p>
    </header>

    <main class="max-w-7xl mx-auto space-y-12">

        <!-- SECTION 1: AI WEALTH STRATEGIST (Hero) -->
        <section class="card p-8 md:p-12 hero-gradient relative overflow-hidden">
            <!-- Decorative Circle -->
            <div class="absolute -right-24 -top-24 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl pointer-events-none"></div>
            
            <div class="relative z-10 grid grid-cols-1 lg:grid-cols-12 gap-12 items-start">
                <div class="lg:col-span-4">
                    <div class="inline-block bg-amber-400 text-blue-900 text-[10px] font-black px-3 py-1 rounded mb-4 uppercase shadow-lg">
                        T√≠nh nƒÉng ƒë·ªôc quy·ªÅn
                    </div>
                    <h2 class="text-3xl font-black mb-6 flex items-center gap-3">
                        K·∫ø Ho·∫°ch 1 T·ª∑ ‚ú®
                    </h2>
                    <p class="text-blue-100 text-sm mb-8 leading-relaxed opacity-90">
                        B·∫°n c√≥ 1 t·ª∑ ƒë·ªìng nh√†n r·ªói? ƒê·ª´ng ƒë·ªÉ ti·ªÅn ng·ªß y√™n. AI s·∫Ω ph√¢n t√≠ch kh·∫©u v·ªã r·ªßi ro v√† ƒë·ªÅ xu·∫•t l·ªô tr√¨nh ph√¢n b·ªï v√†o c√°c gi·ªè "Thanh kho·∫£n", "An to√†n" v√† "TƒÉng tr∆∞·ªüng" t·∫°i H√† Tƒ©nh.
                    </p>
                    
                    <div class="bg-white/10 p-5 rounded-2xl border border-white/10 mb-6 backdrop-blur-sm">
                        <label class="block text-[10px] font-bold uppercase opacity-60 mb-2 tracking-widest">Ch·ªçn kh·∫©u v·ªã c·ªßa b·∫°n</label>
                        <select id="wealth-risk" class="w-full bg-transparent text-white font-bold outline-none cursor-pointer text-lg appearance-none">
                            <option value="C√¢n b·∫±ng" class="text-slate-900">‚öñÔ∏è C√¢n b·∫±ng (Khuy√™n d√πng)</option>
                            <option value="An to√†n" class="text-slate-900">üõ°Ô∏è An to√†n (∆Øu ti√™n Big 4)</option>
                            <option value="L·ª£i nhu·∫≠n" class="text-slate-900">üöÄ T·ªëi ƒëa l·ª£i nhu·∫≠n (7.2%)</option>
                        </select>
                    </div>

                    <button onclick="generateWealthPlan()" id="wealth-btn" class="w-full bg-white text-blue-900 font-black py-4 rounded-xl shadow-2xl hover:bg-blue-50 transition-all flex justify-center items-center gap-2 group">
                        <span>THI·∫æT L·∫¨P L·ªò TR√åNH</span>
                        <i class="fa-solid fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                        <div id="wealth-loading" class="hidden w-4 h-4 border-2 border-blue-900 border-t-transparent rounded-full animate-spin"></div>
                    </button>
                </div>

                <div class="lg:col-span-8 bg-white/5 border border-white/10 rounded-3xl p-8 min-h-[400px] relative">
                    <div id="wealth-plan-display" class="text-sm text-blue-50 leading-relaxed whitespace-pre-line h-full overflow-y-auto custom-scrollbar pr-2">
                        <div class="flex flex-col items-center justify-center h-full opacity-30 text-center">
                            <i class="fa-solid fa-robot text-6xl mb-4"></i>
                            <p class="font-bold italic text-lg">"Ch√†o b·∫°n, t√¥i l√† Orchestrator AI.<br>H√£y ch·ªçn kh·∫©u v·ªã v√† nh·∫•n n√∫t ƒë·ªÉ t√¥i l·∫≠p k·∫ø ho·∫°ch."</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: MARKET KPI & CHART -->
        <section class="space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card p-6 border-l-4 border-emerald-500 flex flex-col justify-between">
                    <div>
                        <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">ƒê·ªânh th·ªã tr∆∞·ªùng (12T)</p>
                        <h3 class="text-3xl font-black text-slate-900 mt-2">7.20%</h3>
                    </div>
                    <div class="mt-4 flex items-center gap-2 text-xs font-bold text-emerald-600">
                        <i class="fa-solid fa-trophy"></i> PGBank H√† Tƒ©nh
                    </div>
                </div>
                <div class="card p-6 border-l-4 border-blue-600 flex flex-col justify-between">
                    <div>
                        <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">M·ª©c s√†n an to√†n</p>
                        <h3 class="text-3xl font-black text-slate-900 mt-2">5.20%</h3>
                    </div>
                    <div class="mt-4 flex items-center gap-2 text-xs font-bold text-blue-600">
                        <i class="fa-solid fa-shield-halved"></i> Nh√≥m Qu·ªëc Doanh
                    </div>
                </div>
                <div class="card p-6 border-l-4 border-amber-500 flex flex-col justify-between">
                    <div>
                        <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">Ch√™nh l·ªách l·ª£i nhu·∫≠n</p>
                        <h3 class="text-3xl font-black text-slate-900 mt-2">2.00%</h3>
                    </div>
                    <div class="mt-4 flex items-center gap-2 text-xs font-bold text-amber-600">
                        <i class="fa-solid fa-scale-unbalanced"></i> C∆° h·ªôi t·ªëi ∆∞u
                    </div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="chart-container">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-bold text-slate-800">X·∫øp H·∫°ng L√£i Su·∫•t (19 Ng√¢n H√†ng)</h3>
                    <div class="flex gap-2">
                        <span class="w-3 h-3 rounded-full bg-blue-800" title="Qu·ªëc doanh"></span>
                        <span class="w-3 h-3 rounded-full bg-blue-500" title="TMCP"></span>
                        <span class="w-3 h-3 rounded-full bg-emerald-500" title="L√£i cao"></span>
                    </div>
                </div>
                <canvas id="rateChart"></canvas>
            </div>
        </section>

        <!-- SECTION 3: AGRIBANK II CONSULTATION (Local Insight) -->
        <section class="card p-8 md:p-12 agri-gradient relative overflow-hidden">
            <i class="fa-solid fa-building-columns absolute -left-10 -bottom-10 text-[15rem] opacity-10"></i>
            <div class="relative z-10">
                <div class="flex flex-col md:flex-row gap-8 items-start">
                    <div class="md:w-1/3">
                        <h2 class="text-3xl font-black mb-4 uppercase tracking-tight">Chi·∫øn L∆∞·ª£c Agribank II</h2>
                        <p class="text-emerald-100 text-sm leading-relaxed mb-6">
                            Ph√¢n t√≠ch chuy√™n s√¢u cho chi nh√°nh m·ªõi n√¢ng c·∫•p t·∫°i H√† Tƒ©nh. Gi·∫£i ph√°p c√¢n b·∫±ng gi·ªØa "L√£i th·∫•p" v√† "An to√†n tuy·ªát ƒë·ªëi".
                        </p>
                        <button onclick="getAgriAdvice()" id="agri-btn" class="bg-white text-emerald-800 font-bold py-3 px-6 rounded-xl shadow-lg hover:bg-emerald-50 transition-all text-xs uppercase tracking-wider flex items-center gap-2">
                            <span>Ph√¢n t√≠ch t√¢m l√Ω</span>
                            <div id="agri-loading" class="hidden w-3 h-3 border-2 border-emerald-800 border-t-transparent rounded-full animate-spin"></div>
                        </button>
                    </div>
                    <div class="md:w-2/3 bg-black/10 rounded-2xl p-6 backdrop-blur-sm border border-white/10">
                        <div id="agri-output" class="text-sm text-white leading-relaxed whitespace-pre-line">
                            <ul class="space-y-3">
                                <li class="flex items-start gap-3"><i class="fa-solid fa-triangle-exclamation text-amber-300 mt-1"></i> <b>N·ªói ƒëau:</b> L√£i su·∫•t 5.2% th·∫•p h∆°n th·ªã tr∆∞·ªùng 2%, c·∫£m gi√°c "thi·ªát th√≤i" khi g·ª≠i ti·ªÅn l·ªõn.</li>
                                <li class="flex items-start gap-3"><i class="fa-solid fa-heart text-red-300 mt-1"></i> <b>Mong mu·ªën:</b> S·ª± an t√¢m tuy·ªát ƒë·ªëi v√† qu√† t·∫∑ng hi·ªán v·∫≠t (b√°t ƒëƒ©a, √°o m∆∞a) ƒë·ªÉ th·∫•y "c√≥ l·ªôc".</li>
                                <li class="flex items-start gap-3"><i class="fa-solid fa-check-circle text-blue-300 mt-1"></i> <b>H√†nh ƒë·ªông:</b> ƒê·∫øn giao d·ªãch l√∫c 10h s√°ng nay ƒë·ªÉ tr√°nh ƒë√¥ng ƒë√∫c, h·ªèi g√≥i "L√¨ x√¨ ƒë·∫ßu xu√¢n".</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: AI BATTLE & ALERTS -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Battle Mode -->
            <div class="card p-8">
                <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                    <i class="fa-solid fa-swords text-blue-600"></i> ƒê·ªëi ƒê·∫ßu Tr·ª±c Di·ªán
                </h3>
                <div class="bg-slate-50 p-4 rounded-2xl border border-slate-100 mb-6">
                    <div class="flex items-center gap-2 mb-4">
                        <select id="compare-1" class="w-full p-2 rounded-lg text-xs font-bold border-slate-200 border outline-none focus:border-blue-500"></select>
                        <span class="font-black text-slate-300 italic text-sm">VS</span>
                        <select id="compare-2" class="w-full p-2 rounded-lg text-xs font-bold border-slate-200 border outline-none focus:border-blue-500"></select>
                    </div>
                    <button onclick="battleAi()" id="battle-btn" class="w-full bg-slate-900 text-white font-bold py-3 rounded-xl hover:bg-slate-700 transition-all text-xs uppercase tracking-widest flex justify-center items-center gap-2">
                        <span>Ph√¢n T√≠ch Ngay</span>
                        <div id="battle-loading" class="hidden w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                    </button>
                </div>
                <div id="battle-output" class="text-sm text-slate-600 leading-relaxed min-h-[100px]">
                    <p class="text-center text-slate-400 italic mt-8">Ch·ªçn 2 ng√¢n h√†ng ƒë·ªÉ xem AI so s√°nh l·ª£i nhu·∫≠n.</p>
                </div>
            </div>

            <!-- Live Alerts -->
            <div class="card p-8 border-2 border-red-50 relative overflow-hidden">
                <div class="absolute top-0 right-0 p-4 opacity-10">
                    <i class="fa-solid fa-bell text-6xl text-red-500"></i>
                </div>
                <h3 class="text-xl font-bold text-red-600 mb-6 flex items-center gap-2">
                    <i class="fa-solid fa-tower-broadcast"></i> C·∫£nh B√°o 08:00
                </h3>
                <div class="space-y-4">
                    <div class="flex items-start gap-3 p-3 bg-red-50 rounded-xl border border-red-100">
                        <i class="fa-solid fa-circle-info text-red-500 mt-1"></i>
                        <p class="text-xs text-red-800"><b>L∆∞u √Ω s√°ng nay:</b> Tr·ªùi c√≥ m∆∞a ph√πn, n√™n ∆∞u ti√™n giao d·ªãch Online ho·∫∑c ƒëi xe √¥ t√¥ ƒë·∫øn c√°c ƒëi·ªÉm giao d·ªãch c√≥ m√°i che.</p>
                    </div>
                    <button onclick="getAlerts()" id="alert-btn" class="w-full bg-red-600 text-white font-bold py-3 rounded-xl hover:bg-red-700 transition-all text-xs uppercase tracking-widest flex justify-center items-center gap-2">
                        <span>Qu√©t Bi·∫øn ƒê·ªông M·ªõi</span>
                        <div id="alert-loading" class="hidden w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                    </button>
                    <div id="alert-output" class="text-xs text-slate-500 italic mt-2"></div>
                </div>
            </div>
        </section>

        <!-- SECTION 5: DETAILED DATA TABLE -->
        <section class="card overflow-hidden p-0">
            <div class="p-6 bg-slate-50 border-b border-slate-100 flex justify-between items-center">
                <h3 class="font-bold text-slate-700 text-sm uppercase tracking-wider">D·ªØ li·ªáu ni√™m y·∫øt (19 Ng√¢n h√†ng)</h3>
                <button class="text-blue-600 text-xs font-bold hover:underline"><i class="fa-solid fa-download"></i> Xu·∫•t Excel</button>
            </div>
            <div class="overflow-x-auto h-[400px] custom-scrollbar">
                <table class="w-full text-left text-sm border-collapse">
                    <thead class="bg-white sticky top-0 z-10 shadow-sm text-slate-500 font-bold uppercase text-[10px] tracking-widest">
                        <tr>
                            <th class="px-6 py-4 border-b">Ng√¢n h√†ng</th>
                            <th class="px-6 py-4 border-b text-center">L√£i su·∫•t (12T)</th>
                            <th class="px-6 py-4 border-b">Ph√¢n kh√∫c</th>
                            <th class="px-6 py-4 border-b text-right">Ghi ch√∫ AI</th>
                        </tr>
                    </thead>
                    <tbody id="table-body" class="divide-y divide-slate-100 bg-white">
                        <!-- JS Content -->
                    </tbody>
                </table>
            </div>
        </section>

    </main>

    <footer class="max-w-7xl mx-auto py-12 text-center border-t border-slate-200 mt-12">
        <p class="text-slate-400 text-[10px] font-bold uppercase tracking-[4px]">
            Orchestrator AI ‚óè Developed for Ha Tinh ‚óè 2026
        </p>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- API KEY CONFIGURATION ---
        // Vui l√≤ng d√°n API Key c·ªßa b·∫°n v√†o d√≤ng d∆∞·ªõi ƒë√¢y
        const apiKey = "AIzaSyCZhyxzguwPihjnRiylSVrbcrVWQMeFeb8"; 

        // --- DATA SOURCE (19 Banks) ---
        const bankData = [
            { name: 'PGBank HT', rate: 7.20, group: 'L√£i cao', note: 'Top 1 l·ª£i nhu·∫≠n' },
            { name: 'Nam A Bank HT', rate: 6.80, group: 'L√£i cao', note: 'Sinh l·ªùi t·ªëi ∆∞u' },
            { name: 'Bac A Bank', rate: 6.55, group: 'L√£i cao', note: 'Uy t√≠n h∆∞u tr√≠' },
            { name: 'LPBank H√† Tƒ©nh', rate: 6.30, group: 'TMCP Nh·ªè', note: 'PGD huy·ªán m·∫°nh' },
            { name: 'SHB H√† Tƒ©nh', rate: 6.20, group: 'TMCP Nh·ªè', note: 'H·ªó tr·ª£ linh ho·∫°t' },
            { name: 'MSB H√† Tƒ©nh', rate: 6.00, group: 'TMCP Nh·ªè', note: 'G·ª≠i online t·ªët' },
            { name: 'VIB H√† Tƒ©nh', rate: 5.80, group: 'TMCP Nh·ªè', note: 'NƒÉng ƒë·ªông' },
            { name: 'HDBank HT', rate: 5.80, group: 'TMCP Nh·ªè', note: 'Qu√† gia d·ª•ng' },
            { name: 'VPBank H√† Tƒ©nh', rate: 5.70, group: 'TMCP L·ªõn', note: 'Cashback App' },
            { name: 'TPBank H√† Tƒ©nh', rate: 5.60, group: 'TMCP L·ªõn', note: 'LiveBank 24/7' },
            { name: 'Sacombank HT', rate: 5.50, group: 'TMCP L·ªõn', note: 'M·∫°ng l∆∞·ªõi ·ªïn' },
            { name: 'Techcombank', rate: 5.45, group: 'TMCP L·ªõn', note: 'Tr·∫£i nghi·ªám s·ªë' },
            { name: 'ACB H√† Tƒ©nh', rate: 5.40, group: 'TMCP L·ªõn', note: 'D·ªãch v·ª• chu·∫©n' },
            { name: 'MBBank H√† Tƒ©nh', rate: 5.30, group: 'TMCP L·ªõn', note: 'App qu√¢n ƒë·ªôi' },
            { name: 'Agribank HT II', rate: 5.20, group: 'Qu·ªëc doanh', note: 'Chi nh√°nh m·ªõi ‚ú®' },
            { name: 'Agribank H√† Tƒ©nh', rate: 5.20, group: 'Qu·ªëc doanh', note: 'An to√†n cao' },
            { name: 'BIDV H√† Tƒ©nh', rate: 5.20, group: 'Qu·ªëc doanh', note: 'Ph·ªï bi·∫øn nh·∫•t' },
            { name: 'VietinBank HT', rate: 5.20, group: 'Qu·ªëc doanh', note: 'Th·ªß t·ª•c chu·∫©n' },
            { name: 'Vietcombank', rate: 5.20, group: 'Qu·ªëc doanh', note: 'Tin c·∫≠y tuy·ªát ƒë·ªëi' }
        ];

        // --- GEMINI API CALLER ---
        async function callGemini(prompt, systemPrompt) {
            if (!apiKey) return "‚ö†Ô∏è Vui l√≤ng d√°n API Key v√†o m√£ ngu·ªìn (d√≤ng 230) ƒë·ªÉ k√≠ch ho·∫°t AI.";
            
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemPrompt || "B·∫°n l√† chuy√™n gia t√†i ch√≠nh t·∫°i H√† Tƒ©nh." }] }
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "Kh√¥ng c√≥ ph·∫£n h·ªìi.";
            } catch (e) {
                return "L·ªói k·∫øt n·ªëi AI. Vui l√≤ng ki·ªÉm tra m·∫°ng ho·∫∑c API Key.";
            }
        }

        // --- AI FEATURES ---
        async function generateWealthPlan() {
            const risk = document.getElementById('wealth-risk').value;
            const display = document.getElementById('wealth-plan-display');
            const btn = document.getElementById('wealth-btn');
            const loader = document.getElementById('wealth-loading');

            btn.disabled = true;
            loader.classList.remove('hidden');
            display.innerHTML = '<div class="flex flex-col items-center justify-center h-full opacity-50"><span class="loading-dots text-2xl font-bold">ƒêang t√≠nh to√°n</span></div>';

            const prompt = `L·∫≠p k·∫ø ho·∫°ch ph√¢n b·ªï 1 t·ª∑ VNƒê t·∫°i H√† Tƒ©nh ng√†y 14/01/2026. Kh·∫©u v·ªã: ${risk}. D·ªØ li·ªáu: ${JSON.stringify(bankData)}. Y√™u c·∫ßu: Chia 3 gi·ªè ti·ªÅn, t√≠nh l√£i c·ª• th·ªÉ, ƒë·ªãnh d·∫°ng g·∫°ch ƒë·∫ßu d√≤ng r√µ r√†ng.`;
            const result = await callGemini(prompt, "B·∫°n l√† c·ªë v·∫•n t√†i ch√≠nh chuy√™n nghi·ªáp, s√∫c t√≠ch, th·ª±c t·∫ø.");
            
            display.innerText = result;
            btn.disabled = false;
            loader.classList.add('hidden');
        }

        async function getAgriAdvice() {
            const display = document.getElementById('agri-output');
            const loader = document.getElementById('agri-loading');
            loader.classList.remove('hidden');
            const prompt = "Ph√¢n t√≠ch t√¢m l√Ω kh√°ch h√†ng g·ª≠i ti·ªÅn t·∫°i Agribank H√† Tƒ©nh II. N·ªói ƒëau (l√£i th·∫•p), Mong mu·ªën (an to√†n), H√†nh ƒë·ªông (vi·ªác c·∫ßn l√†m ngay). Ng·∫Øn g·ªçn.";
            display.innerText = await callGemini(prompt);
            loader.classList.add('hidden');
        }

        async function battleAi() {
            const b1 = document.getElementById('compare-1').value;
            const b2 = document.getElementById('compare-2').value;
            const display = document.getElementById('battle-output');
            const loader = document.getElementById('battle-loading');
            
            loader.classList.remove('hidden');
            const d1 = bankData.find(b => b.name === b1);
            const d2 = bankData.find(b => b.name === b2);
            
            const prompt = `So s√°nh ${b1} (${d1.rate}%) vs ${b2} (${d2.rate}%). T√≠nh ch√™nh l·ªách l√£i tr√™n 1 t·ª∑. Ai th·∫Øng v·ªÅ ti·ªÅn? Ai th·∫Øng v·ªÅ uy t√≠n?`;
            const result = await callGemini(prompt, "Chuy√™n gia so s√°nh ng√¢n h√†ng.");
            
            display.innerHTML = `<div class="p-3 bg-slate-50 border rounded-xl text-sm italic">${result}</div>`;
            loader.classList.add('hidden');
        }

        async function getAlerts() {
            const display = document.getElementById('alert-output');
            const loader = document.getElementById('alert-loading');
            loader.classList.remove('hidden');
            const prompt = "C·∫£nh b√°o bi·∫øn ƒë·ªông l√£i su·∫•t H√† Tƒ©nh s√°ng 14/01. Ng·∫Øn g·ªçn 2 d√≤ng.";
            display.innerText = await callGemini(prompt);
            loader.classList.add('hidden');
        }

        // --- UI INITIALIZATION ---
        function initUI() {
            // Chart
            const ctx = document.getElementById('rateChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: bankData.map(b => b.name),
                    datasets: [{
                        label: 'L√£i su·∫•t (%)',
                        data: bankData.map(b => b.rate),
                        backgroundColor: bankData.map(b => b.group === 'Qu·ªëc doanh' ? '#1E40AF' : (b.group === 'L√£i cao' ? '#10B981' : '#3B82F6')),
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { min: 4, max: 8 }, x: { display: false } }
                }
            });

            // Select Options
            const s1 = document.getElementById('compare-1');
            const s2 = document.getElementById('compare-2');
            bankData.forEach(b => {
                s1.add(new Option(b.name, b.name));
                s2.add(new Option(b.name, b.name));
            });
            s1.value = "Agribank HT II";
            s2.value = "PGBank HT";

            // Table
            const tbody = document.getElementById('table-body');
            bankData.sort((a,b) => b.rate - a.rate).forEach(b => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-50 transition-colors";
                tr.innerHTML = `
                    <td class="px-6 py-4 font-bold text-slate-800">${b.name}</td>
                    <td class="px-6 py-4 text-center font-black text-blue-900">${b.rate.toFixed(2)}%</td>
                    <td class="px-6 py-4 text-xs font-bold text-slate-400 uppercase">${b.group}</td>
                    <td class="px-6 py-4 text-right"><span class="bg-slate-100 text-slate-600 px-2 py-1 rounded text-[10px] font-bold">${b.note}</span></td>
                `;
                tbody.appendChild(tr);
            });
        }

        window.onload = initUI;
    </script>
</body>
</html>